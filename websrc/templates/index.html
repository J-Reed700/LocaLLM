<!DOCTYPE html>
<html lang="en">
{include 'components/head.html' %}
<body class="bg-dark text-gray-200" x-cloak :class="darkMode ? 'bg-dark text-gray-200' : 'bg-white text-gray-800'" x-data="{ darkMode: true }">
    {% include 'components/nav.html' %}
    {% with page_type='Home' %}
        {% include 'components/settings-modal.html' %}
    {% endwith %}
    
    <div class="flex flex-col md:flex-row h-[calc(100vh-4rem)]" x-data="chat()" x-init="initializeChat">
        {% include 'components/chat/sidebar.html' %}
        {% include 'components/chat/main-area.html' %}
    </div>

    {% include 'components/scripts/chat.html' %}
    <style>
    .loading-spinner {
        display: inline-block;
        width: 24px;
        height: 24px;
        border: 2px solid var(--primary);
        border-top-color: transparent;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    </style>

    <script>
    document.addEventListener('htmx:configRequest', function(evt) {
        const target = evt.detail.elt.getAttribute('hx-target');
        const responseDiv = document.querySelector(target);
        const spinner = responseDiv.querySelector('.loading-spinner');
        if (spinner) spinner.hidden = false;
    });

    document.addEventListener('htmx:afterSwap', function(evt) {
        const target = evt.detail.elt.getAttribute('hx-target');
        const responseDiv = document.querySelector(target);
        const spinner = responseDiv.querySelector('.loading-spinner');
        if (spinner) spinner.hidden = true;
    });
    </script>

    <style>
        .conversation-card {
            transition: all 0.2s ease-in-out;
        }
        
        .conversation-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 
                        0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .conversation-card.active {
            border-color: var(--primary);
        }
    </style>

    <style>
        .loading-dots {
            display: inline-block;
            animation: loading-dots 1.4s infinite both;
        }

        @keyframes loading-dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60% { content: '...'; }
            80%, 100% { content: ''; }
        }
    </style>
</body>
</html>